# 论文推荐本地缓存选项功能说明

## 📋 功能概述

在论文推荐功能中新增了"从本地缓存获取论文"选项，让用户可以灵活控制论文推荐的数据源。

## 🎛️ 使用方法

### 界面位置
- 在**文献详情页面**的左侧推荐文献区域
- 位于"获取相关文献"按钮下方
- 与"扩大范围，不限顶刊顶会文献"选项并列

### 选项说明

#### ✅ 勾选"从本地缓存获取论文"（默认状态）
- **行为**: 优先从本地数据库缓存搜索相关论文
- **备用策略**: 如果本地缓存不足5篇，自动调用外部API补充
- **优势**: 
  - 响应速度快
  - 质量较高（已经过筛选和增强）
  - 包含研究方法等详细信息
  - 支持中文翻译
- **适用场景**: 日常使用，追求质量和速度

#### ❌ 不勾选"从本地缓存获取论文"
- **行为**: 跳过本地缓存搜索，直接从外部API获取
- **数据源**: 
  - 外部论文池（如果可用）
  - Semantic Scholar API
- **优势**:
  - 获取最新发布的论文
  - 数据源更广泛
  - 不受本地缓存限制
- **适用场景**: 寻找最新研究、本地缓存内容不足时

## 🔄 工作流程对比

### 启用本地缓存模式
```
用户请求 → 本地缓存搜索 → 结果充足？
                    ↓ 是          ↓ 否
                返回结果    → 外部API补充 → 合并返回
```

### 禁用本地缓存模式  
```
用户请求 → 跳过本地缓存 → 外部论文池检查 → Semantic Scholar API → 返回结果
```

## 📊 功能效果

### 控制台输出示例

#### 启用本地缓存时：
```
🔍 搜索模式: 本地缓存 + 外部搜索
📊 推荐统计: 缓存命中 3 篇, 外部获取 2 篇
⚙️ 后端确认设置: 使用本地缓存 = true
```

#### 禁用本地缓存时：
```
🔍 搜索模式: 仅外部搜索  
📊 推荐统计: 缓存命中 0 篇, 外部获取 5 篇
⚙️ 后端确认设置: 使用本地缓存 = false
✅ 已按要求跳过本地缓存搜索，所有结果均来自外部API
```

## 🎯 使用建议

### 推荐启用本地缓存的情况：
- ✅ 日常文献查找
- ✅ 需要详细的研究方法信息
- ✅ 希望快速获得高质量结果
- ✅ 网络条件不稳定时

### 推荐禁用本地缓存的情况：
- ✅ 寻找最新发布的论文
- ✅ 本地缓存内容有限的专业领域
- ✅ 需要更广泛的文献覆盖
- ✅ 验证外部API的最新结果

## 🔧 技术实现

### 前端修改
- 新增 `useLocalCache` 响应式变量（默认true）
- UI添加勾选框控件
- API请求中传递 `use_local_cache` 参数

### 后端修改  
- 接收 `use_local_cache` 参数（默认true）
- 根据参数决定是否调用 `searchFromCache` 函数
- 更新统计信息和日志输出
- 保证在禁用缓存时仍能正常获取外部结果

## 💡 注意事项

1. **默认设置**: 新功能默认启用本地缓存，保持现有用户体验
2. **性能影响**: 禁用本地缓存会增加外部API调用，可能影响响应速度
3. **结果差异**: 两种模式可能返回不同的论文，这是正常现象
4. **网络依赖**: 禁用本地缓存时完全依赖外部网络服务

## 🚀 后续优化

- 可考虑添加缓存状态指示器
- 支持缓存更新策略配置
- 添加本地缓存管理功能 