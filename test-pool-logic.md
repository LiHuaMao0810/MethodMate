# 论文池机制测试指南

## 功能说明
我们已经实现了智能论文池机制来解决外部API重复返回相同结果的问题：

### 工作流程
1. **首次推荐**：建立20篇论文的论文池，从中选择5篇显示
2. **再次推荐**：直接从论文池中选择未显示的5篇论文（无需API调用）
3. **论文池耗尽**：当可用论文不足时，论文池大小翻倍并重新获取

## 测试步骤

### 1. 清空状态测试
- 刷新页面或清空对话
- 第一次点击"获取相关文献"
- **预期**：调用外部API，建立论文池，显示5篇论文

### 2. 论文池使用测试
- 在第一次获取后，再次点击"获取相关文献"
- **预期**：不调用外部API，直接从论文池获取5篇新论文
- **关键标志**：控制台显示"✅ 从外部论文池成功获取论文"

### 3. 论文池扩展测试
- 连续点击"获取相关文献"直到论文池耗尽
- **预期**：当可用论文不足时，自动扩展论文池（20->40->80...）

## 调试信息

查看浏览器控制台，关键日志包括：

### 前端日志
- `🔍 基本论文池状态`: 显示当前论文池状态
- `📋 可用的未使用论文数`: 显示可用论文数量
- `🏊‍♂️ 外部论文池可用性`: 显示是否使用论文池
- `📤 发送给后端的论文池数据`: 显示传递给后端的数据

### 后端日志
- `🔍 论文池使用检查`: 显示论文池使用条件检查
- `✅ 满足论文池使用条件`: 确认使用论文池
- `✅ 从外部论文池成功获取论文`: 成功从池中获取
- `🚀 论文池将扩展至 X 篇`: 论文池扩展提示

## 状态指示器

页面上的论文池状态指示器显示：
- 可用论文数/总论文数
- 当前关键词
- 清空论文池按钮

## 预期行为

✅ **正确行为**
- 第一次：外部API调用 + 建立论文池
- 第二次：直接从论文池获取，无API调用
- 第三次：直接从论文池获取，无API调用
- 论文池耗尽时：扩展论文池

❌ **错误行为**  
- 每次都调用外部API
- 论文池状态不更新
- 重复显示相同论文

## 故障排除

如果论文池不工作：
1. 检查控制台日志确认论文池状态
2. 查看`poolAvailable`是否为true
3. 确认`unusedPapers.length >= 1`
4. 验证后端接收到论文池数据 